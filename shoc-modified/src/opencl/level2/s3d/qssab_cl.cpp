const char *cl_source_qssab =
"#ifdef K_DOUBLE_PRECISION\n"
"#define DOUBLE_PRECISION\n"
"#pragma OPENCL EXTENSION cl_khr_fp64: enable\n"
"#elif AMD_DOUBLE_PRECISION\n"
"#define DOUBLE_PRECISION\n"
"#pragma OPENCL EXTENSION cl_amd_fp64: enable\n"
"#endif\n"
"\n"
"// Macros to explicitly control precision of the constants, otherwise\n"
"// known to cause problems for some Compilers\n"
"#ifdef DOUBLE_PRECISION\n"
"#define CPREC(a) a\n"
"#else\n"
"#define CPREC(a) a##f\n"
"#endif\n"
"\n"
"//replace divisions by multiplication with the reciprocal\n"
"#define REPLACE_DIV_WITH_RCP 1\n"
"\n"
"//Call the appropriate math function based on precision\n"
"#ifdef DOUBLE_PRECISION\n"
"#define real double\n"
"#if REPLACE_DIV_WITH_RCP\n"
"#define DIV(x,y) ((x)*(1.0/(y)))\n"
"#else\n"
"#define DIV(x,y) ((x)/(y))\n"
"#endif\n"
"#define POW pow\n"
"#define EXP exp\n"
"#define EXP10 exp10\n"
"#define EXP2 exp2\n"
"#define MAX fmax\n"
"#define MIN fmin\n"
"#define LOG log\n"
"#define LOG10 log10\n"
"#else\n"
"#define real float\n"
"#if REPLACE_DIV_WITH_RCP\n"
"#define DIV(x,y) ((x)*(1.0f/(y)))\n"
"#else\n"
"#define DIV(x,y) ((x)/(y))\n"
"#endif\n"
"#define POW pow\n"
"#define EXP exp\n"
"#define EXP10 exp10\n"
"#define EXP2 exp2\n"
"#define MAX fmax\n"
"#define MIN fmin\n"
"#define LOG log\n"
"#define LOG10 log10\n"
"#endif\n"
"\n"
"//Kernel indexing macros\n"
"#define thread_num (get_global_id(0))\n"
"#define idx2(p,z) (p[(((z)-1)*(N_GP)) + thread_num])\n"
"#define idx(x, y) ((x)[(y)-1])\n"
"#define C(q)     idx2(C, q)\n"
"#define Y(q)     idx2(Y, q)\n"
"#define RF(q)    idx2(RF, q)\n"
"#define EG(q)    idx2(EG, q)\n"
"#define RB(q)    idx2(RB, q)\n"
"#define RKLOW(q) idx2(RKLOW, q)\n"
"#define ROP(q)   idx(ROP, q)\n"
"#define WDOT(q)  idx2(WDOT, q)\n"
"#define RKF(q)   idx2(RKF, q)\n"
"#define RKR(q)   idx2(RKR, q)\n"
"#define A_DIM    (11)\n"
"#define A(b, c)  idx2(A, (((b)*A_DIM)+c) )\n"
"\n"
"\n"
"__kernel void\n"
"qssab_kernel(__global real* RF, __global real* RB, __global real* A)\n"
"{\n"
"\n"
"    real DEN;\n"
"\n"
"    A(8,0) = A(8,0) + A(8,10)*A(10,0);\n"
"    DEN = 1 -A(8,10)*A(10,8);\n"
"    A(8,0) = DIV (A(8,0), DEN);\n"
"    A(8,4) = DIV (A(8,4), DEN);\n"
"    A(8,3) = DIV (A(8,3), DEN);\n"
"    A(3,0) = A(3,0) + A(3,5)*A(5,0);\n"
"    DEN = 1 -A(3,5)*A(5,3);\n"
"    A(3,0) = DIV (A(3,0), DEN);\n"
"    A(3,4) = DIV (A(3,4), DEN);\n"
"    A(3,2) = DIV (A(3,2), DEN);\n"
"    A(3,1) = DIV (A(3,1), DEN);\n"
"    A(3,8) = DIV (A(3,8), DEN);\n"
"    A(3,6) = DIV (A(3,6), DEN);\n"
"    A(4,0) = A(4,0) + A(4,9)*A(9,0);\n"
"    A(4,7) = A(4,7) + A(4,9)*A(9,7);\n"
"    DEN = 1 -A(4,9)*A(9,4);\n"
"    A(4,0) = DIV (A(4,0), DEN);\n"
"    A(4,3) = DIV (A(4,3), DEN);\n"
"    A(4,7) = DIV (A(4,7), DEN);\n"
"    A(4,2) = DIV (A(4,2), DEN);\n"
"    A(4,1) = DIV (A(4,1), DEN);\n"
"    A(4,8) = DIV (A(4,8), DEN);\n"
"    A(7,0) = A(7,0) + A(7,9)*A(9,0);\n"
"    A(7,4) = A(7,4) + A(7,9)*A(9,4);\n"
"    DEN = 1 -A(7,9)*A(9,7);\n"
"    A(7,0) = DIV (A(7,0), DEN);\n"
"    A(7,4) = DIV (A(7,4), DEN);\n"
"    A(7,2) = DIV (A(7,2), DEN);\n"
"    A(7,1) = DIV (A(7,1), DEN);\n"
"    A(7,6) = DIV (A(7,6), DEN);\n"
"    A(3,0) = A(3,0) + A(3,6)*A(6,0);\n"
"    A(3,7) = A(3,6)*A(6,7);\n"
"    A(3,2) = A(3,2) + A(3,6)*A(6,2);\n"
"    DEN = 1 -A(3,6)*A(6,3);\n"
"    A(3,0) = DIV (A(3,0), DEN);\n"
"    A(3,4) = DIV (A(3,4), DEN);\n"
"    A(3,7) = DIV (A(3,7), DEN);\n"
"    A(3,2) = DIV (A(3,2), DEN);\n"
"    A(3,1) = DIV (A(3,1), DEN);\n"
"    A(3,8) = DIV (A(3,8), DEN);\n"
"    A(7,0) = A(7,0) + A(7,6)*A(6,0);\n"
"    A(7,3) = A(7,6)*A(6,3);\n"
"    A(7,2) = A(7,2) + A(7,6)*A(6,2);\n"
"    DEN = 1 -A(7,6)*A(6,7);\n"
"    A(7,0) = DIV (A(7,0), DEN);\n"
"    A(7,4) = DIV (A(7,4), DEN);\n"
"    A(7,3) = DIV (A(7,3), DEN);\n"
"    A(7,2) = DIV (A(7,2), DEN);\n"
"    A(7,1) = DIV (A(7,1), DEN);\n"
"    A(2,0) = A(2,0) + A(2,6)*A(6,0);\n"
"    A(2,3) = A(2,3) + A(2,6)*A(6,3);\n"
"    A(2,7) = A(2,7) + A(2,6)*A(6,7);\n"
"    DEN = 1 -A(2,6)*A(6,2);\n"
"    A(2,0) = DIV (A(2,0), DEN);\n"
"    A(2,4) = DIV (A(2,4), DEN);\n"
"    A(2,3) = DIV (A(2,3), DEN);\n"
"    A(2,7) = DIV (A(2,7), DEN);\n"
"    A(2,1) = DIV (A(2,1), DEN);\n"
"    A(4,0) = A(4,0) + A(4,8)*A(8,0);\n"
"    A(4,3) = A(4,3) + A(4,8)*A(8,3);\n"
"    DEN = 1 -A(4,8)*A(8,4);\n"
"    A(4,0) = DIV (A(4,0), DEN);\n"
"    A(4,3) = DIV (A(4,3), DEN);\n"
"    A(4,7) = DIV (A(4,7), DEN);\n"
"    A(4,2) = DIV (A(4,2), DEN);\n"
"    A(4,1) = DIV (A(4,1), DEN);\n"
"    A(3,0) = A(3,0) + A(3,8)*A(8,0);\n"
"    A(3,4) = A(3,4) + A(3,8)*A(8,4);\n"
"    DEN = 1 -A(3,8)*A(8,3);\n"
"    A(3,0) = DIV (A(3,0), DEN);\n"
"    A(3,4) = DIV (A(3,4), DEN);\n"
"    A(3,7) = DIV (A(3,7), DEN);\n"
"    A(3,2) = DIV (A(3,2), DEN);\n"
"    A(3,1) = DIV (A(3,1), DEN);\n"
"    A(4,0) = A(4,0) + A(4,1)*A(1,0);\n"
"    A(4,3) = A(4,3) + A(4,1)*A(1,3);\n"
"    A(4,7) = A(4,7) + A(4,1)*A(1,7);\n"
"    A(4,2) = A(4,2) + A(4,1)*A(1,2);\n"
"    DEN = 1 -A(4,1)*A(1,4);\n"
"    A(4,0) = DIV (A(4,0), DEN);\n"
"    A(4,3) = DIV (A(4,3), DEN);\n"
"    A(4,7) = DIV (A(4,7), DEN);\n"
"    A(4,2) = DIV (A(4,2), DEN);\n"
"    A(3,0) = A(3,0) + A(3,1)*A(1,0);\n"
"    A(3,4) = A(3,4) + A(3,1)*A(1,4);\n"
"    A(3,7) = A(3,7) + A(3,1)*A(1,7);\n"
"    A(3,2) = A(3,2) + A(3,1)*A(1,2);\n"
"    DEN = 1 -A(3,1)*A(1,3);\n"
"    A(3,0) = DIV (A(3,0), DEN);\n"
"    A(3,4) = DIV (A(3,4), DEN);\n"
"    A(3,7) = DIV (A(3,7), DEN);\n"
"    A(3,2) = DIV (A(3,2), DEN);\n"
"    A(7,0) = A(7,0) + A(7,1)*A(1,0);\n"
"    A(7,4) = A(7,4) + A(7,1)*A(1,4);\n"
"    A(7,3) = A(7,3) + A(7,1)*A(1,3);\n"
"    A(7,2) = A(7,2) + A(7,1)*A(1,2);\n"
"    DEN = 1 -A(7,1)*A(1,7);\n"
"    A(7,0) = DIV (A(7,0), DEN);\n"
"    A(7,4) = DIV (A(7,4), DEN);\n"
"    A(7,3) = DIV (A(7,3), DEN);\n"
"    A(7,2) = DIV (A(7,2), DEN);\n"
"    A(2,0) = A(2,0) + A(2,1)*A(1,0);\n"
"    A(2,4) = A(2,4) + A(2,1)*A(1,4);\n"
"    A(2,3) = A(2,3) + A(2,1)*A(1,3);\n"
"    A(2,7) = A(2,7) + A(2,1)*A(1,7);\n"
"    DEN = 1 -A(2,1)*A(1,2);\n"
"    A(2,0) = DIV (A(2,0), DEN);\n"
"    A(2,4) = DIV (A(2,4), DEN);\n"
"    A(2,3) = DIV (A(2,3), DEN);\n"
"    A(2,7) = DIV (A(2,7), DEN);\n"
"    A(4,0) = A(4,0) + A(4,2)*A(2,0);\n"
"    A(4,3) = A(4,3) + A(4,2)*A(2,3);\n"
"    A(4,7) = A(4,7) + A(4,2)*A(2,7);\n"
"    DEN = 1 -A(4,2)*A(2,4);\n"
"    A(4,0) = DIV (A(4,0), DEN);\n"
"    A(4,3) = DIV (A(4,3), DEN);\n"
"    A(4,7) = DIV (A(4,7), DEN);\n"
"    A(3,0) = A(3,0) + A(3,2)*A(2,0);\n"
"    A(3,4) = A(3,4) + A(3,2)*A(2,4);\n"
"    A(3,7) = A(3,7) + A(3,2)*A(2,7);\n"
"    DEN = 1 -A(3,2)*A(2,3);\n"
"    A(3,0) = DIV (A(3,0), DEN);\n"
"    A(3,4) = DIV (A(3,4), DEN);\n"
"    A(3,7) = DIV (A(3,7), DEN);\n"
"    A(7,0) = A(7,0) + A(7,2)*A(2,0);\n"
"    A(7,4) = A(7,4) + A(7,2)*A(2,4);\n"
"    A(7,3) = A(7,3) + A(7,2)*A(2,3);\n"
"    DEN = 1 -A(7,2)*A(2,7);\n"
"    A(7,0) = DIV (A(7,0), DEN);\n"
"    A(7,4) = DIV (A(7,4), DEN);\n"
"    A(7,3) = DIV (A(7,3), DEN);\n"
"    A(4,0) = A(4,0) + A(4,7)*A(7,0);\n"
"    A(4,3) = A(4,3) + A(4,7)*A(7,3);\n"
"    DEN = 1 -A(4,7)*A(7,4);\n"
"    A(4,0) = DIV (A(4,0), DEN);\n"
"    A(4,3) = DIV (A(4,3), DEN);\n"
"    A(3,0) = A(3,0) + A(3,7)*A(7,0);\n"
"    A(3,4) = A(3,4) + A(3,7)*A(7,4);\n"
"    DEN = 1 -A(3,7)*A(7,3);\n"
"    A(3,0) = DIV (A(3,0), DEN);\n"
"    A(3,4) = DIV (A(3,4), DEN);\n"
"    A(4,0) = A(4,0) + A(4,3)*A(3,0);\n"
"    DEN = 1 -A(4,3)*A(3,4);\n"
"    A(4,0) = DIV (A(4,0), DEN);\n"
"}\n"
;
